<%- include ('../partials/header') %>

<style>
    .containershop {
  display: flex;
  margin-left: auto;
  margin-right: auto;
  width: fit-content;
}
    .nextto{
        display: table-row;

    }

    .filtre{
        width: 170px;
        

        
}

.filtre h5{
        text-align: center;
        background-color: lightgray;
        padding: 10;        
}

    .filtre ul{
        list-style-type: none;
        text-align: left;
        padding: 0 10 10 10;
}

.filtre ul li a{
    color: black;
       text-align: left;
}

</style>


<div class="containershop">


   
    <div class="px-4 mt-5 nextto filtre">
<!--add combobox with : price desc / price asc / a-z / (z-a ?)     
    add logo cart -->

    <div class = "combo">
        <select name="sort" id="sort">
            <option value="A-Z" >A-Z</option>
            <option value="Prix desc">Prix desc</option>
            <option value="Prix asc">Prix asc</option>
        </select>
    </div>

     <!--Fitre-->
    <h5>Filtre</h5>
    <form action="/boutique" method="get">

        <ul>
        
            <li>
                <input class="input_" id="vetement" type="checkbox" onclick ="loadDoc ('habit')">
                <label class="input" for="vetement">Vêtement</label>
            </li>
            <li>
                <input class="input" id="maquette" type="checkbox" onclick ="loadDoc ('miniature')">
                <label class="input" for="maquette">Maquette</label>
            </li>
            <li>
                <input class="input" id="souvenir" type="checkbox" onclick ="loadDoc ('goodie')">
                <label class="input" for="souvenir">Souvenir</label>
            </li>
            <li>
                <input class="input" id="educatif" type="checkbox" onclick ="loadDoc ('education')">
                <label class="input" for="educatif">Educatif</label>
            </li>
            <li>
                <input type="submit" value="Effacer Filtre" class="btn btn-primary my-2" style="background-color: #182030;"></input>
            </li>
        </ul> 
    </form>
</div>

<% if (items !=undefined && items.length>0) {%>
<!-- Section-->
<section class=" nextto">
    <div class="container px-4 px-lg-5 mt-5">
        <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center">
            <% items.forEach(function(item,index){ %>
                <div class="col mb-5">
                    <div class="card h-100">
                        <!-- Product image-->
                        <img class="card-img-top" src="<%= item.image%>" alt="..." />
                        <!-- Product details-->
                        <div class="card-body p-4">
                            <div class="text-center">
                                <!-- Product name-->
                                <h5 class="fw-bolder " style="line-height: 1em;"><%= item.titre%></h5>
                                <!-- Productdescription-->
                                    <p><%= item.desc%></p>
                                <!-- Product price-->
                                <p>$ <%= item.prix%></p>
                                
                            </div>
                        </div>
                        <!-- Product actions-->
                        <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                            <div class="text-center"><a class="btn btn-primary my-2" style="background-color: #182030;" href="#">Ajouter au panier</a></div>
                        </div>
                    </div>
                </div>
            <%}); %>
        </div>
    </div>
    </section>

    <% }else {%>
    <section class="py-5 text-center container">
      <div class="row py-lg-5">
        <div class="col-lg-6 col-md-8 mx-auto">
          <h1 class="fw-light">Aucune donnée trouvée.</h1>
          <a href="/" class="btn btn-primary my-2" style="background-color: #182030;">Retour à l'accueil</a>
          </p>
        </div>
      </div>
    </section>
    <% } %>
</div>
<%- include ('../partials/footer') %>

<script>
    $(document).ready(function () {    
      var nom,prenom,email,adresse,telephone,datetime,rdv,film,billets_id = [];
  
      $("#submit").click(function () {
  
        nom = $("#nom").val();
        prenom = $("#prenom").val();
        email = $("#email").val();
        adresse = $("#adresse").val();
        telephone = $("#telephone").val();
        datetime = $("#datetime").val();
        rdv = $("#rdv").is(':checked');
        film = $("#film").is(':checked');
  
  
        if (email.includes("@") && email.includes(".") && email.length > 5 && nom.length > 0 && prenom.length > 0 && adresse.length > 0 && datetime.length > 0) {
          var isBillet = false;
  
          billets_id.forEach(tarif => {
            if (parseInt(tarif) > 0)
              isBillet = true;
          });
  
          if (isBillet) {
            $.post("/billet", { nom:nom,prenom:prenom,email:email,adresse:adresse,telephone:telephone,datetime:datetime,rdv:rdv,film:film,billets_id:billets_id }, 
            function (data) {
              if (data === 'done') {
                window.location.href = "/";
              }
              if (data === 'error') {
                alert('Erreur inconnue');
              }
            });
          } else {
            alert('Veuillez selectionner au moins un billet.');
          }
          
        }
      });
  
    });
    var total_billet = 0;
  </script>